#!/usr/bin/env bash

set -e

uuid="$1"

# 1. GNOME shell version
shell_version=$(gnome-shell --version | cut -d' ' -f3)

# 2. Fetch extension info (for the given shell version)
info_json=$(curl -sS "https://extensions.gnome.org/extension-info/?uuid=$uuid&shell_version=$shell_version")

# 3. Extract download url from the json with jq
download_url=$(echo $info_json | jq --raw-output ".download_url" )

# 4. Install the extension
gnome-extensions install "https://extensions.gnome.org$download_url"